# تحديث صفحة حصص الانتظار - تحويل المحتوى إلى بطاقات منظمة

## التاريخ
21 نوفمبر 2025

## الملف المعدّل
`src/pages/Dashboard/ScheduleSettingsFinal.tsx`

## الوصف
تم تحويل محتوى الخطوة الثالثة (حصص الانتظار) في صفحة إعدادات الجدول إلى بطاقات منظمة قابلة للطي/الفتح بنفس تصميم الخطوة الأولى (المعلمون) والخطوة الثانية (المواد).

## التغييرات المنفذة

### 1. إضافة حالات التحكم بالبطاقات
تم إضافة ثلاث حالات جديدة للتحكم بفتح/إغلاق البطاقات:
```typescript
const [isDemandMatrixOpen, setIsDemandMatrixOpen] = useState(false);
const [isDistributionStrategyOpen, setIsDistributionStrategyOpen] = useState(false);
const [isTeachersSetupOpen, setIsTeachersSetupOpen] = useState(false);
```

### 2. هيكل البطاقات الجديد

#### البطاقة الأولى: مصفوفة الاحتياج للحصص
**الرقم:** 1
**المحتوى:**
- حقل إدخال العدد المستهدف للمنتظرين في الحصة الواحدة
- جدول عدد الحصص اليومية (الأحد - الخميس)
- ملخص إحصائي:
  - إجمالي الحصص الأسبوعية
  - المقاعد المطلوبة
  - السعة المتوفرة
- مؤشر التوازن (شريط تقدم)

**الميزات:**
- قابلة للطي/الفتح
- تأثيرات حركية (slideDown/slideUp)
- تصميم احترافي بتدرجات اللون الأزرق
- أيقونة ChevronDown تدور عند الفتح/الإغلاق

#### البطاقة الثانية: استراتيجية التوزيع
**الرقم:** 2
**المحتوى:**
- خياران للتوزيع:
  1. **توزيع تلقائي (تعبئة السعة):** يملأ جداول المعلمين حتى الحد الأقصى
  2. **توزيع حسب الهدف:** يلتزم بالعدد المحدد في مصفوفة الاحتياج

**الميزات:**
- اختيار واحد من الخيارين
- تصميم بطاقات تفاعلية مع تأثيرات hover
- مؤشرات بصرية للخيار المحدد

#### البطاقة الثالثة: إعداد المعلمين
**الرقم:** 3
**المحتوى:**
- زر "إضافة منتظر" في الرأس
- جدول شامل للمعلمين يحتوي على:
  - المعلم (الاسم والمادة)
  - شريط التقدم (نصاب الحصص)
  - نصاب الحصص الأساسي
  - نصاب الانتظار (قابل للتعديل)
  - السعة المتبقية
  - الحد الأقصى اليومي
  - العمليات (حظر حصص، حذف)
- ملاحظات وتحذيرات:
  - قاعدة الـ 24 حصة
  - تحذير عند التجاوز
- إعدادات هدف التغطية (للتوزيع حسب الهدف):
  - حقل تحديد العدد
  - زر التحقق من القابلية
  - جدول المنتظرين (قابل للإخفاء/الإظهار)

**الميزات:**
- جدول تفاعلي كامل
- شريط تقدم بصري لكل معلم
- تحذيرات تلقائية عند التجاوز
- إمكانية إضافة منتظرين مخصصين

### 3. بطاقة الملاحظات المهمة
**محتوى منفصل:**
- ملاحظات عن نظام الانتظار
- القواعد والاستثناءات
- تصميم منسق مع البطاقات الأخرى

### 4. أزرار الإجراءات
تم وضع أزرار الحفظ والتصدير خارج البطاقات:
- **زر تصدير الإعدادات:** تصدير كل الإعدادات بصيغة JSON
- **زر حفظ الإعدادات:** حفظ جميع التغييرات

## مميزات التصميم الجديد

### 1. التنظيم والترتيب
- بطاقات مرقمة من 1 إلى 3
- كل بطاقة مسؤولة عن جزء محدد
- سهولة التنقل والتركيز على قسم واحد

### 2. التفاعلية
- إمكانية طي/فتح كل بطاقة بشكل مستقل
- تأثيرات حركية سلسة
- أيقونة ChevronDown تتحرك مع الحالة

### 3. الاتساق مع الخطوات الأخرى
- نفس تصميم بطاقات الخطوة الأولى والثانية
- نفس الألوان والتدرجات
- نفس أسلوب الأيقونات والعناوين

### 4. إدارة المساحة
- البطاقات مغلقة افتراضياً
- يمكن فتح واحدة أو أكثر حسب الحاجة
- يقلل من الازدحام البصري

### 5. الوضوح
- كل بطاقة لها عنوان واضح ورقم
- التنظيم الهرمي واضح
- سهولة الفهم والاستخدام

## الحالة الافتراضية للبطاقات
جميع البطاقات **مغلقة** بشكل افتراضي:
```typescript
const [isDemandMatrixOpen, setIsDemandMatrixOpen] = useState(false);
const [isDistributionStrategyOpen, setIsDistributionStrategyOpen] = useState(false);
const [isTeachersSetupOpen, setIsTeachersSetupOpen] = useState(false);
```

يمكن للمستخدم فتحها حسب الحاجة.

## التأثيرات الحركية
تم استخدام تأثيرات CSS للانتقال السلس:
```tsx
style={{
  animation: isOpen ? 'slideDown 0.3s ease-out' : 'slideUp 0.3s ease-out'
}}
```

## الألوان المستخدمة
- **اللون الأساسي:** `#4f46e5` (Indigo)
- **اللون الثانوي:** `#6366f1` (Light Indigo)
- **التدرجات:** من `indigo-50` إلى `blue-50`
- **الأيقونات:** `#4f46e5`

## الأيقونات المستخدمة
- **البطاقة 1:** CalendarDays (في المحتوى)
- **البطاقة 2:** Settings (في المحتوى)
- **البطاقة 3:** Users (في المحتوى)
- **الملاحظات:** Info
- **التحكم:** ChevronDown

## التوافق
- ✅ متوافق مع التصميم الحالي
- ✅ متوافق مع الخطوة الأولى والثانية
- ✅ مستجيب (Responsive)
- ✅ يدعم اللغة العربية (RTL)
- ✅ لا توجد أخطاء في الكود

## الاختبار
تم التحقق من:
- ✅ عدم وجود أخطاء في الكود
- ✅ صحة هيكل HTML/JSX
- ✅ إغلاق جميع العناصر بشكل صحيح
- ✅ التنسيق والمحاذاة

## ملاحظات
- تم الحفاظ على كل الوظائف والمنطق البرمجي
- تم تحسين التنظيم البصري فقط
- لم يتم تغيير أي API أو دوال
- النظام جاهز للاستخدام مباشرة

## التوصيات المستقبلية
1. إضافة حفظ حالة البطاقات (مفتوحة/مغلقة) في localStorage
2. إمكانية فتح/إغلاق جميع البطاقات مرة واحدة
3. إضافة tooltips توضيحية للحقول
4. إضافة تصدير/استيراد إعدادات كاملة

---

**تم التحديث بنجاح ✓**
